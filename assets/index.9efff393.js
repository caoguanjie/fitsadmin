import{y as e,c as t,ar as a,o as i,n as l,S as o,ac as r,X as s,f as n,h as d,N as p,H as m,u as c,A as b,j as f,L as u,M as g}from"./vxetable.23d9f74f.js";import{c as h}from"./system.cd36e9a4.js";import{_ as v,c as y,y as D}from"./index.53c6c89d.js";import{F as P,c as k,g as x,d as T,h as w,i as C}from"./index.14f8690e.js";import{u as I}from"./FitsTableProHook.1f485441.js";import"./echarts.d8b3161e.js";import"./moment.9709ab41.js";const j={class:"department-manage"},R=["onClick"],S=["onClick"],q=e({name:"Department"});var W=v(e({...q,setup(e){const{user:v}=y(),q=t(),W={keepSource:!0,id:"department-part",rowConfig:{height:52,isHover:!0,useKey:!0},storage:{enabled:!0,key:"SystemManageDepartmentList",dataBase:v.userInfo.id},formConfig:{items:[{field:"name",span:3,title:"部门名称",itemRender:{name:"$input",props:{placeholder:"请输入部门名称"}}},{field:"code",span:3,title:"部门编码",itemRender:{name:"$input",props:{placeholder:"请输入部门编码"}}},{field:"status",span:3,title:"部门状态",itemRender:{name:"$select",options:[{value:"0",label:"启用"},{value:"1",label:"停用"}],props:{placeholder:"请选择状态"}}}]},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:60},{field:"Title",title:"部门名称",minWidth:210,treeNode:!0},{field:"code",title:"部门编码",minWidth:150,align:"center"},{field:"Sort",title:"排序",minWidth:150,align:"center"},{field:"remark",title:"备注",minWidth:120},{field:"status",title:"部门状态",minWidth:120,slots:{default:"status"},align:"center"},{field:"CreateTime",title:"创建时间",minWidth:180,align:"center"},{field:"Operation",title:"操作",minWidth:150,slots:{default:"operate"},fixed:"right"}],showOverflow:"tooltip",toolbarConfig:{buttons:[{code:"add",name:"新增部门",status:"primary"},{code:"enable",name:"启用"},{code:"disable",name:"禁用"},{code:"export",name:"导出"},{code:"Depdelete",name:"批量删除"}],tools:{enabled:!0}},treeConfig:{transform:!0,rowField:"id",parentField:"PId"},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((t=>{h(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:i}=e;t(i?{result:a.toTreeArray(i.TableList,{clear:!0}),page:{total:i.ItemCount}}:{result:[],page:{total:0}})}))}))}},tooltipConfig:{contentMethod:({column:e,row:t})=>{const{field:a}=e;if("remark"===a)return t[a]}}},_={async toolbarButtonClick({code:e}){let t=q.value.fitsTablePro.getCheckboxRecords();switch(e){case"add":L.visible=!0,L.dialogProp.title="新增部门";break;case"enable":t.length?(A.baseDepartment.visible=!0,A.baseDepartment.dialogText="是否确定启用选中的部门?",A.baseDepartment.key="Departmentenable"):D({message:"未选中启动的相关部门",type:"error"});break;case"disable":t.length?(A.baseDepartment.visible=!0,A.baseDepartment.dialogText="是否确定禁用选中的部门?",A.baseDepartment.key="Departmentdisable"):D({message:"未选中禁用的相关部门",type:"error"});break;case"export":break;case"Depdelete":t.length?(A.baseDepartment.visible=!0,A.baseDepartment.dialogText="是否确定删除选中的部门?",A.baseDepartment.key="Departmentremove"):D({message:"未选中删除的相关部门",type:"error"})}}};let F=t();const{fitsTablePro:V}=I(W,q);i((()=>{l((()=>{})),setTimeout((()=>{}),2e3)}));const A=o({addDepartment:{visible:!1,props:{title:"新增部门",width:"40%"},info:{}},baseDepartment:{dialogText:"",key:"",visible:!1,props:{title:"提示",width:"30%"}}}),B=e=>{switch(e){case"addDepartment":A.addDepartment.visible=!1;break;case"baseDepartment":A.baseDepartment.visible=!1,q.value.fitsTablePro.setAllCheckboxRow(!1)}};let E=t();const L=o({visible:!1,forms:[{form:new P({rule:[{type:"title",field:"PId",title:"上级部门",component:r(x),props:{options:new k({select:{placeholder:"请选择",clearable:!0},input:{placeholder:"部门搜索"},tree:{nodeKey:"id",data:[{id:"150000198607018427",label:"广州华侨医院",children:[{id:"15000019860701848",PId:"150000198607018427",label:"医院医技",children:[{id:"15000019860701842",PId:"15000019860701848",label:"医院医技01"},{id:"15000019860701846",PId:"15000019860701848",label:"医院医技02"}]}]},{id:"150000198607018400",label:"广州第一人民医院",children:[{id:"16000019860701848",PId:"150000198607018400",label:"医院医技",children:[{id:"15100019860701842",PId:"16000019860701848",label:"医院医技01"},{id:"15120019860701842",PId:"16000019860701848",label:"医院医技02"}]}]},{id:"150100198607018400",label:"广州南方医科附属第三医院",children:[{id:"16000019860701748",PId:"150100198607018400",label:"医院医技",children:[{id:"15100019860721842",PId:"16000019860701748",label:"医院医技01"},{id:"15100019860751842",PId:"16000019860701748",label:"医院医技02"}]}]}],checkStrictly:!0}})},validate:[{required:!0,message:"请选择",trigger:"change"}]},{type:"input",field:"Title",title:"部门名称",props:{placeholder:"请输入"},effect:{required:"请输入部门名称"}},{type:"input",field:"code",title:"部门编号",props:{placeholder:"请输入"},effect:{required:"请输入部门编号"}},{type:"input",field:"remark",title:"部门描述",props:{placeholder:"请输入"}},{type:"input",field:"Sort",title:"排序",props:{placeholder:"请输入"}},{type:"radio",field:"status",title:"状态",options:[{value:!0,label:"启用"},{value:!1,label:"禁用"}]}],option:{form:{labelPosition:"right",inline:!0},submitBtn:!1,resetBtn:!1},col:1})}],dialogProp:{title:"",width:"35%"},formType:"dialog"});function H(e){if(L.dialogProp.title="新增部门")L.visible=!1;else if(L.dialogProp.title="修改部门"){let t=q.value.fitsTablePro.reactData.tableData.find((e=>e.id==E.value.id));Object.assign(t,e),q.value.fitsTablePro.commitProxy("query"),L.visible=!1}}return(e,t)=>{const a=s("el-switch");return n(),d("div",j,[p(c(T),{option:c(V),ref_key:"xGrid",ref:q,"grid-events":_},{operate:m((({slotProps:e})=>[f("span",{onClick:t=>{return a=e.row,E.value=a,L.visible=!0,L.dialogProp.title="修改部门","null"===a.PId&&(a.PId=a.id),void l((()=>{F.value.formRef.forEach((e=>{e.fApi.setValue(a)}))}));var a}},"编辑",8,R),f("span",{onClick:t=>(async e=>{A.baseDepartment.visible=!0,A.baseDepartment.dialogText="是否确定删除选中的部门?"})(e.row)},"删除",8,S)])),status:m((({slotProps:e})=>[p(a,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["option"]),p(c(w),{option:L,onSubmit:H,onCancel:t[0]||(t[0]=e=>L.visible=!1),class:"dialogFormExample",ref_key:"formtypeRef",ref:F},null,8,["option"]),p(c(C),{class:b(["baseDepartment","Department-baseDialog"]),visible:A.baseDepartment.visible,dialogProp:A.baseDepartment.props,onSubmit:t[1]||(t[1]=e=>(e=>{const t=q.value;let a=q.value.fitsTablePro.getCheckboxRecords(!0);switch(e){case"Departmentenable":a.forEach(((e,t)=>{e.status=!0})),l((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentdisable":a.forEach(((e,t)=>{e.status=!1})),l((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentremove":t.fitsTablePro.remove(a),l((()=>{t.fitsTablePro.commitProxy("query")}))}B("baseDepartment")})(A.baseDepartment.key)),onCancel:t[2]||(t[2]=e=>B("baseDepartment"))},{default:m((()=>[u(g(A.baseDepartment.dialogText),1)])),_:1},8,["visible","dialogProp"])])}}}),[["__scopeId","data-v-4246b1bb"]]);export{W as default};
