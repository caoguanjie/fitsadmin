import{n as e,q as l,U as a,p as t,x as o,a4 as s,a5 as i,a2 as d,a3 as n,V as u,z as r,a0 as m,l as f}from"./index-b6db054e.js";import{b as p}from"./system-f299a2f0.js";import{u as c}from"./FitsTableProHook-a8ee8569.js";import{v as b,a as v,f as x,h,i as g,F as _,I as y,u as V,p as C,M as U,G as k,_ as w}from"./vxetable-1644ac3d.js";import"./echarts-c32f5a2f.js";const W={class:"exportBase"},j={class:"contain"},I={class:"buttonClass"},E={href:"https://vxetable.cn/#/table/advanced/export",target:"_blank",style:{"margin-left":"15px"}},P={class:"tableClass"},T=b({name:"ExploreExcel"}),z=f(b({...T,setup(f){const{user:b}=e(),T=v(),z={keepSource:!1,showOverflow:"tooltip",id:"rolestable",rowConfig:{height:52,isCurrent:!0},storage:{enabled:!0,key:"ExampleRoleList",dataBase:b.userInfo.id},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:50},{field:"Indexes",title:"序号",type:"seq",minWidth:80},{field:"Uname",title:"角色名称",minWidth:130},{field:"Ucode",title:"角色编码",minWidth:130},{field:"Udescribe",title:"角色描述",minWidth:130},{field:"Sort",title:"排序",minWidth:100},{field:"Ustate",title:"角色状态",slots:{default:"state"},minWidth:100}],toolbarConfig:{buttons:[],tools:{enabled:!1}},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((l=>{p(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:a}=e;l(a?{result:a.TableList,page:{total:a.ItemCount}}:{result:[],page:{total:0}})}))}))}}},{fitsTablePro:S}=c(z,T),q=()=>{T.value.fitsTablePro.exportData({type:B.value,filename:L.value,useStyle:D.value})};let L=v("默认文件名"),B=v("csv"),D=v(!0);const F=[{value:"csv",label:"csv"},{value:"html",label:"html"},{value:"xml",label:"xml"},{value:"txt",label:"txt"}];return(e,f)=>{const p=t,c=o,b=s,v=i,z=d,G=n,R=u,H=r,M=l,O=m;return x(),h("div",W,[g("div",j,[g("div",I,[_(M,{inline:!0,class:"demo-form-inline"},{default:y((()=>[_(c,{label:"导出文件名称："},{default:y((()=>[_(p,{modelValue:V(L),"onUpdate:modelValue":f[0]||(f[0]=e=>C(L)?L.value=e:L=e),placeholder:"请输入文件名"},null,8,["modelValue"])])),_:1}),_(c,{label:"是否根据Table宽度导出："},{default:y((()=>[_(v,{modelValue:V(D),"onUpdate:modelValue":f[1]||(f[1]=e=>C(D)?D.value=e:D=e),class:"ml-4"},{default:y((()=>[_(b,{label:!0,size:"large"},{default:y((()=>[U("是")])),_:1}),_(b,{label:!1,size:"large"},{default:y((()=>[U("否")])),_:1})])),_:1},8,["modelValue"])])),_:1}),_(c,{label:"导出文件格式："},{default:y((()=>[_(G,{modelValue:V(B),"onUpdate:modelValue":f[2]||(f[2]=e=>C(B)?B.value=e:B=e),placeholder:"请选择文件格式"},{default:y((()=>[(x(),h(k,null,w(F,((e,l)=>_(z,{key:l,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),_(c,{label:""},{default:y((()=>[g("a",E,[_(R,{type:"info"},{default:y((()=>[U("Excel导出相关资料")])),_:1})])])),_:1}),_(c,null,{default:y((()=>[_(H,{style:{"margin-bottom":"10px"},onClick:q,type:"primary"},{default:y((()=>[U("导出Excel")])),_:1})])),_:1})])),_:1})]),g("div",P,[_(V(a),{option:V(S),ref_key:"xGrid",ref:T},{state:y((({slotProps:e})=>[_(O,{modelValue:e.row.Ustate,"onUpdate:modelValue":l=>e.row.Ustate=l,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["option"])])])])}}}),[["__scopeId","data-v-73611e8e"]]);export{z as default};
