import{a4 as e,K as a,J as l,a5 as t,a6 as o,r as s,v as i,x as d,p as r,z as n,q as p,l as u,n as c,Q as m,X as y,Z as b}from"./index-2b8f59d9.js";import{v as f,B as g,a as h,b as k,ar as C,f as T,h as _,i as v,F as w,I as V,u as x,y as I,J as U,M as D,O as P,D as S,d as j,n as z,N as L}from"./vxetable-90850a7d.js";import{d as W}from"./system-c8a00e86.js";import{u as q}from"./FitsTableProHook-c0d1a0dd.js";import{E,a as F}from"./el-radio-f8efcffb.js";import"./echarts-c32f5a2f.js";const R={class:"add-role"},M={class:"add-content"},N={style:{display:"flex",width:"100%","justify-content":"space-between"}},A={key:1,style:{display:"flex","justify-content":"flex-start"}},O={key:3,style:{display:"flex","justify-content":"space-between",width:"100%"}},B={class:"add-bottom"},J=u(f({__name:"addMenu",props:{keys:String,setData:Object,requireData:Array},emits:["dataChange","closeDialog"],setup(u,{emit:c}){const m=`${s}/mock/78/api/uploadPDF`,y=g(new e({select:{clearable:!0}})),b=c,f=u,j=g(new a({select:{clearable:!0},tree:{nodeKey:"Id",data:[],checkStrictly:!0}})),z=h("default"),L=h();let W=g({Title:"",Icon:"",Type:"",Sort:"",ComponentPath:"",IsUrL:!1,IsCache:!1,State:!1,CreateTime:"",Address:"",ComponentName:""});k((()=>f.setData),(()=>{W=Object.assign(W,f.setData)}),{immediate:!0,deep:!0}),k((()=>f.requireData),(()=>{j.tree.data=Object.assign(j.tree.data,f.requireData),C.eachTree(j.tree.data,(e=>{e.label=e.Title}),{children:"children"})}),{immediate:!0,deep:!0});const q=g({Title:[{required:!0,message:"请输入菜单标题",trigger:"blur"}],Type:[{required:!0,message:"请选择菜单类型",trigger:"blur"},{min:3,max:10,message:"长度请大于3，小于10",trigger:"blur"}]}),J=e=>{"cancle"!=e?L.value&&L.value.validate((e=>{if(!e)return i({message:"必填项未填写完整！",type:"warning"}),!1;if("edit"==f.keys){let e=C.clone(W);b("dataChange",e,f.keys),b("closeDialog","operate")}else if("add"==f.keys){let e=C.clone(W);b("dataChange",e,f.keys),b("closeDialog","operate")}})):b("closeDialog","operate")};return(e,a)=>{const s=d,i=r,u=n,c=E,b=F,f=p;return T(),_("div",R,[v("div",M,[w(f,{ref_key:"ruleFormRef",ref:L,model:x(W),rules:q,"label-width":"120px",class:"demo-ruleForm",size:z.value,"status-icon":""},{default:V((()=>[w(s,{label:"上级目录",prop:"CreateTime"},{default:V((()=>[w(x(l),I({options:j},x(W).CreateTime),null,16,["options"])])),_:1}),w(s,{label:"菜单类型",prop:"Type"},{default:V((()=>[w(i,{style:{display:"none"}}),"mulu"!=x(W).Type?(T(),U(u,{key:0,class:"add-button",onClick:a[0]||(a[0]=e=>x(W).Type="mulu")},{default:V((()=>[D("目录")])),_:1})):P("",!0),"mulu"==x(W).Type?(T(),U(u,{key:1,class:"add-button",onClick:a[1]||(a[1]=e=>x(W).Type="mulu"),type:"primary",plain:""},{default:V((()=>[D("目录")])),_:1})):P("",!0),"caidan"!=x(W).Type?(T(),U(u,{key:2,class:"add-button",onClick:a[2]||(a[2]=e=>x(W).Type="caidan")},{default:V((()=>[D("菜单 ")])),_:1})):P("",!0),"caidan"==x(W).Type?(T(),U(u,{key:3,class:"add-button",onClick:a[3]||(a[3]=e=>x(W).Type="caidan"),type:"primary",plain:""},{default:V((()=>[D("菜单")])),_:1})):P("",!0),"anniu"!=x(W).Type?(T(),U(u,{key:4,class:"add-button",onClick:a[4]||(a[4]=e=>x(W).Type="anniu")},{default:V((()=>[D("按钮")])),_:1})):P("",!0),"anniu"==x(W).Type?(T(),U(u,{key:5,class:"add-button",onClick:a[5]||(a[5]=e=>x(W).Type="anniu"),type:"primary",plain:""},{default:V((()=>[D("按钮")])),_:1})):P("",!0),"shuju"!=x(W).Type?(T(),U(u,{key:6,class:"add-button",onClick:a[6]||(a[6]=e=>x(W).Type="shuju")},{default:V((()=>[D("数据")])),_:1})):P("",!0),"shuju"==x(W).Type?(T(),U(u,{key:7,class:"add-button",onClick:a[7]||(a[7]=e=>x(W).Type="shuju"),type:"primary",plain:""},{default:V((()=>[D("数据")])),_:1})):P("",!0)])),_:1}),w(s,{label:"菜单图标"},{default:V((()=>[v("div",N,[w(x(t),{options:y,class:S("addMenuClass")},null,8,["options"]),w(x(o),{url:m,type:["images"],ClassName:"uploadClass"},{mybutton:V((()=>[w(u,{class:"add-button",type:"primary",plain:""},{default:V((()=>[D("开始上传")])),_:1})])),_:1})])])),_:1}),"anniu"!=x(W).Type?(T(),U(s,{key:0,label:"菜单标题",prop:"Title"},{default:V((()=>[w(i,{modelValue:x(W).Title,"onUpdate:modelValue":a[8]||(a[8]=e=>x(W).Title=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):P("",!0),"anniu"!=x(W).Type?(T(),_("div",A,[w(s,{label:"菜单状态",prop:"State",style:{display:"flex","align-items":"center"}},{default:V((()=>[w(b,{modelValue:x(W).State,"onUpdate:modelValue":a[9]||(a[9]=e=>x(W).State=e),class:"ml-4"},{default:V((()=>[w(c,{label:!0,size:"large"},{default:V((()=>[D("启用")])),_:1}),w(c,{label:!1,size:"large"},{default:V((()=>[D("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1}),w(s,{label:"外链菜单",prop:"IsUrL",style:{display:"flex","align-items":"center"}},{default:V((()=>[w(b,{modelValue:x(W).IsUrL,"onUpdate:modelValue":a[10]||(a[10]=e=>x(W).IsUrL=e),class:"ml-4"},{default:V((()=>[w(c,{label:!0,size:"large"},{default:V((()=>[D("是")])),_:1}),w(c,{label:!1,size:"large"},{default:V((()=>[D("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])):P("",!0),"anniu"==x(W).Type?(T(),U(s,{key:2,label:"按钮名称",prop:"Title"},{default:V((()=>[w(i,{modelValue:x(W).Title,"onUpdate:modelValue":a[11]||(a[11]=e=>x(W).Title=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):P("",!0),"caidan"==x(W).Type?(T(),_("div",O,[w(s,{label:"组件名称",prop:"ComponentName",style:{display:"flex","align-items":"center"}},{default:V((()=>[w(i,{modelValue:x(W).ComponentName,"onUpdate:modelValue":a[12]||(a[12]=e=>x(W).ComponentName=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),w(s,{label:"组件路径",prop:"Address",style:{display:"flex","align-items":"center"}},{default:V((()=>[w(i,{modelValue:x(W).Address,"onUpdate:modelValue":a[13]||(a[13]=e=>x(W).Address=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])):P("",!0),"anniu"!=x(W).Type?(T(),U(s,{key:4,label:"路由地址",prop:"ComponentPath"},{default:V((()=>[w(i,{modelValue:x(W).ComponentPath,"onUpdate:modelValue":a[14]||(a[14]=e=>x(W).ComponentPath=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):P("",!0),w(s,{label:"菜单排序",prop:"Sort"},{default:V((()=>[w(i,{modelValue:x(W).Sort,"onUpdate:modelValue":a[15]||(a[15]=e=>x(W).Sort=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","size"])]),v("div",B,[w(u,{class:"add-button",size:"large",onClick:a[16]||(a[16]=e=>J("cancle"))},{default:V((()=>[D("取消")])),_:1}),w(u,{class:"add-button",type:"primary",size:"large",onClick:a[17]||(a[17]=e=>J("submit"))},{default:V((()=>[D("确定 ")])),_:1})])])}}}),[["__scopeId","data-v-4cbf094a"]]),K={class:"menu-manage"},G=["onClick"],H=["onClick"],Q=f({name:"Menu"}),X=u(f({...Q,setup(e){const{user:a}=c(),l=h(),t={keepSource:!0,showOverflow:!1,id:"toolbar_demo_1",rowConfig:{height:52},storage:{enabled:!0,key:"SystemManageMenuList",dataBase:a.userInfo.id},formConfig:{items:[{field:"keyword",title:"模糊搜索",itemRender:{name:"ElInput",props:{placeholder:"请输入菜单关键字、权限标识、路径"}}}]},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:50},{field:"Title",title:"菜单标题",minWidth:130,treeNode:!0},{field:"Icon",title:"图标",minWidth:100},{field:"Type",title:"组件标识",minWidth:100},{field:"ComponentPath",title:"组件路径",minWidth:100},{field:"IsUrL",title:"外链",minWidth:100,slots:{default:"isUrL"}},{field:"IsCache",title:"缓存",minWidth:100,slots:{default:"isCache"}},{field:"State",title:"菜单状态",slots:{default:"state"},minWidth:100},{field:"Sort",title:"排序",minWidth:80},{field:"CreateTime",title:"创建日期",minWidth:130},{field:"Operation",title:"操作",minWidth:150,slots:{default:"operate"},fixed:"right"}],toolbarConfig:{buttons:[{code:"myadd",name:"新增",status:"primary",onClick:()=>{alert(1)}},{code:"mySave",name:"启用"},{code:"mydisable",name:"禁用"},{code:"myExport",name:"导出"},{code:"mydelete",name:"批量删除"}],tools:{enabled:!0}},treeConfig:{transform:!0,rowField:"Id",parentField:"PId"},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((a=>{W(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:l}=e;l?(o.value=l.TableList,a({result:C.toTreeArray(l.TableList,{clear:!0}),page:{total:l.ItemCount}})):a({result:[],page:{total:0}})}))}))}}};let o=h("");const{fitsTablePro:s}=q(t,l),d={async toolbarButtonClick({code:e}){if(l.value.fitsTablePro.getCheckboxRecords().length||"myadd"==e)switch(e){case"myadd":{n.operate.visible=!0,n.operate.key="add";let e={Title:"",Icon:"",Type:"",Sort:"",ComponentPath:"",IsUrL:!1,IsCache:!1,State:!1,CreateTime:""};n.operate.data=e;break}case"mySave":n.base.visible=!0,n.base.dialogText="是否启用所选菜单？";break;case"mydisable":n.base.visible=!0,n.base.dialogText="是否禁用所选菜单？";break;case"myExport":n.base.visible=!0,n.base.dialogText="是否导出所选菜单？";break;case"mydelete":n.base.visible=!0,n.base.dialogText="是否删除所选菜单？"}else r()}},r=()=>{i({message:"请选择至少一个角色！",type:"warning"})},n=g({base:{dialogText:"",key:"",visible:!1,props:{title:"",width:"30%"}},operate:{dialogText:"",key:"",visible:!1,data:{},props:{title:"",width:"50%"}}}),p=e=>{switch(e){case"operate":n.operate.visible=!1;break;case"base":n.base.visible=!1}};j((()=>{z((()=>{})),setTimeout((()=>{}),2e3)}));const u=(e,a)=>{"edit"==n.operate.key||n.operate.key},f=(e,a)=>{"edit"==a?(n.operate.visible=!0,n.operate.props.title="编辑菜单",n.operate.key="editRole",n.operate.data=e):"delete"==a&&(n.base.visible=!0,n.base.dialogText="是否确定关联选中的用户？",n.base.key="relaRole")};return(e,a)=>{const t=b;return T(),_("div",K,[w(x(m),{option:x(s),ref_key:"xGrid",ref:l,"grid-events":d},{operate:V((({slotProps:e})=>[v("span",{class:"FromButton underline",onClick:a=>f(e.row,"edit")},"编辑",8,G),v("span",{class:"FromButton delete",onClick:a=>f(e.row,"delete")},"删除",8,H)])),isUrl:V((({slotProps:e})=>[w(t,{modelValue:e.row.IsUrl,"onUpdate:modelValue":a=>e.row.IsUrl=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),isCache:V((({slotProps:e})=>[w(t,{modelValue:e.row.IsCache,"onUpdate:modelValue":a=>e.row.IsCache=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),state:V((({slotProps:e})=>[w(t,{modelValue:e.row.IsEnabled,"onUpdate:modelValue":a=>e.row.IsEnabled=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["option"]),w(x(y),{class:S("Menu-baseDialog"),visible:x(n).base.visible,dialogProp:x(n).base.props,onCancel:a[0]||(a[0]=e=>p("base")),onSubmit:a[1]||(a[1]=e=>(e=>{let a=l.value.fitsTablePro.getCheckboxRecords(!0);switch(e){case"Dictable":a.forEach(((e,a)=>{e.IsEnabled=!0}));break;case"Dictunable":a.forEach(((e,a)=>{e.IsEnabled=!1}))}p("base")})(x(n).base.key))},{default:V((()=>[D(L(x(n).base.dialogText),1)])),_:1},8,["visible","dialogProp"]),w(x(y),{class:S("onfooter"),visible:x(n).operate.visible,"dialogData.relateRole.visible":"false",dialogProp:x(n).operate.props,showFooter:!1,onCancel:a[2]||(a[2]=e=>p("operate"))},{default:V((()=>[w(J,{onDataChange:u,onCloseDialog:p,keys:x(n).operate.key,setData:x(n).operate.data,requireData:x(o)},null,8,["keys","setData","requireData"])])),_:1},8,["visible","dialogProp"])])}}}),[["__scopeId","data-v-d8723456"]]);export{X as default};
