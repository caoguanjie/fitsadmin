import{m as e,F as t,Q as a,H as l,N as i,T as o,U as r,V as s,j as n}from"./index-3ec253b2.js";import{E as d,a as p,aC as m,d as c,n as b,J as f,ah as u,l as g,m as h,O as v,R as y,p as D,u as P,V as k,W as x,L as T}from"./vxetable-1fe7c1fd.js";import{c as C}from"./system-5f401a68.js";import{u as w}from"./FitsTableProHook-1dfe0252.js";import{E as I}from"./index-7f015466.js";import"./echarts-1215139a.js";const R={class:"department-manage"},j=["onClick"],W=["onClick"],q=d({name:"Department"}),S=n(d({...q,setup(n){const{user:d}=e(),q=p(),S={keepSource:!0,id:"department-part",rowConfig:{height:52,isHover:!0,useKey:!0},storage:{enabled:!0,key:"SystemManageDepartmentList",dataBase:d.userInfo.id},formConfig:{items:[{field:"name",span:3,title:"部门名称",itemRender:{name:"$input",props:{placeholder:"请输入部门名称"}}},{field:"code",span:3,title:"部门编码",itemRender:{name:"$input",props:{placeholder:"请输入部门编码"}}},{field:"status",span:3,title:"部门状态",itemRender:{name:"$select",options:[{value:"0",label:"启用"},{value:"1",label:"停用"}],props:{placeholder:"请选择状态"}}}]},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:60},{field:"Title",title:"部门名称",minWidth:210,treeNode:!0},{field:"code",title:"部门编码",minWidth:150,align:"center"},{field:"Sort",title:"排序",minWidth:150,align:"center"},{field:"remark",title:"备注",minWidth:120},{field:"status",title:"部门状态",minWidth:120,slots:{default:"status"},align:"center"},{field:"CreateTime",title:"创建时间",minWidth:180,align:"center"},{field:"Operation",title:"操作",minWidth:150,slots:{default:"operate"},fixed:"right"}],showOverflow:"tooltip",toolbarConfig:{buttons:[{code:"add",name:"新增部门",status:"primary"},{code:"enable",name:"启用"},{code:"disable",name:"禁用"},{code:"export",name:"导出"},{code:"Depdelete",name:"批量删除"}],tools:{enabled:!0}},treeConfig:{transform:!0,rowField:"id",parentField:"PId"},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((t=>{C(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:a}=e;t(a?{result:m.toTreeArray(a.TableList,{clear:!0}),page:{total:a.ItemCount}}:{result:[],page:{total:0}})}))}))}},tooltipConfig:{contentMethod:({column:e,row:t})=>{const{field:a}=e;if("remark"===a)return t[a]}}},V={async toolbarButtonClick({code:e}){let t=q.value.fitsTablePro.getCheckboxRecords();switch(e){case"add":O.visible=!0,O.dialogProp.title="新增部门";break;case"enable":t.length?(F.baseDepartment.visible=!0,F.baseDepartment.dialogText="是否确定启用选中的部门?",F.baseDepartment.key="Departmentenable"):I({message:"未选中启动的相关部门",type:"error"});break;case"disable":t.length?(F.baseDepartment.visible=!0,F.baseDepartment.dialogText="是否确定禁用选中的部门?",F.baseDepartment.key="Departmentdisable"):I({message:"未选中禁用的相关部门",type:"error"});break;case"export":break;case"Depdelete":t.length?(F.baseDepartment.visible=!0,F.baseDepartment.dialogText="是否确定删除选中的部门?",F.baseDepartment.key="Departmentremove"):I({message:"未选中删除的相关部门",type:"error"})}}};let E=p();const{fitsTablePro:_}=w(S,q);c((()=>{b((()=>{})),setTimeout((()=>{}),2e3)}));const F=f({addDepartment:{visible:!1,props:{title:"新增部门",width:"40%"},info:{}},baseDepartment:{dialogText:"",key:"",visible:!1,props:{title:"提示",width:"30%"}}}),B=e=>{switch(e){case"addDepartment":F.addDepartment.visible=!1;break;case"baseDepartment":F.baseDepartment.visible=!1,q.value.fitsTablePro.setAllCheckboxRow(!1)}};let L=p();const O=f({visible:!1,forms:[{form:new t({rule:[{type:"title",field:"PId",title:"上级部门",component:u(a),props:{options:new l({select:{placeholder:"请选择",clearable:!0},input:{placeholder:"部门搜索"},tree:{nodeKey:"id",data:[{id:"150000198607018427",label:"广州华侨医院",children:[{id:"15000019860701848",PId:"150000198607018427",label:"医院医技",children:[{id:"15000019860701842",PId:"15000019860701848",label:"医院医技01"},{id:"15000019860701846",PId:"15000019860701848",label:"医院医技02"}]}]},{id:"150000198607018400",label:"广州第一人民医院",children:[{id:"16000019860701848",PId:"150000198607018400",label:"医院医技",children:[{id:"15100019860701842",PId:"16000019860701848",label:"医院医技01"},{id:"15120019860701842",PId:"16000019860701848",label:"医院医技02"}]}]},{id:"150100198607018400",label:"广州南方医科附属第三医院",children:[{id:"16000019860701748",PId:"150100198607018400",label:"医院医技",children:[{id:"15100019860721842",PId:"16000019860701748",label:"医院医技01"},{id:"15100019860751842",PId:"16000019860701748",label:"医院医技02"}]}]}],checkStrictly:!0}})},validate:[{required:!0,message:"请选择",trigger:"change"}]},{type:"input",field:"Title",title:"部门名称",props:{placeholder:"请输入"},effect:{required:"请输入部门名称"}},{type:"input",field:"code",title:"部门编号",props:{placeholder:"请输入"},effect:{required:"请输入部门编号"}},{type:"input",field:"remark",title:"部门描述",props:{placeholder:"请输入"}},{type:"input",field:"Sort",title:"排序",props:{placeholder:"请输入"}},{type:"radio",field:"status",title:"状态",options:[{value:!0,label:"启用"},{value:!1,label:"禁用"}]}],option:{form:{labelPosition:"right",inline:!0},submitBtn:!1,resetBtn:!1},col:1})}],dialogProp:{title:"",width:"35%"},formType:"dialog"});function A(e){if(O.dialogProp.title="新增部门")O.visible=!1;else if(O.dialogProp.title="修改部门"){let t=q.value.fitsTablePro.reactData.tableData.find((e=>e.id==L.value.id));Object.assign(t,e),q.value.fitsTablePro.commitProxy("query"),O.visible=!1}}return(e,t)=>{const a=s;return g(),h("div",R,[v(P(i),{option:P(_),ref_key:"xGrid",ref:q,"grid-events":V},{operate:y((({slotProps:e})=>[D("span",{onClick:t=>{return a=e.row,L.value=a,O.visible=!0,O.dialogProp.title="修改部门","null"===a.PId&&(a.PId=a.id),void b((()=>{E.value.formRef.forEach((e=>{e.fApi.setValue(a)}))}));var a}},"编辑",8,j),D("span",{onClick:t=>(async e=>{F.baseDepartment.visible=!0,F.baseDepartment.dialogText="是否确定删除选中的部门?"})(e.row)},"删除",8,W)])),status:y((({slotProps:e})=>[v(a,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["option"]),v(P(o),{option:P(O),onSubmit:A,onCancel:t[0]||(t[0]=e=>P(O).visible=!1),class:"dialogFormExample",ref_key:"formtypeRef",ref:E},null,8,["option"]),v(P(r),{class:T(["baseDepartment","Department-baseDialog"]),visible:P(F).baseDepartment.visible,dialogProp:P(F).baseDepartment.props,onSubmit:t[1]||(t[1]=e=>(e=>{const t=q.value;let a=q.value.fitsTablePro.getCheckboxRecords(!0);switch(e){case"Departmentenable":a.forEach(((e,t)=>{e.status=!0})),b((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentdisable":a.forEach(((e,t)=>{e.status=!1})),b((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentremove":t.fitsTablePro.remove(a),b((()=>{t.fitsTablePro.commitProxy("query")}))}B("baseDepartment")})(P(F).baseDepartment.key)),onCancel:t[2]||(t[2]=e=>B("baseDepartment"))},{default:y((()=>[k(x(P(F).baseDepartment.dialogText),1)])),_:1},8,["visible","dialogProp"])])}}}),[["__scopeId","data-v-86622d49"]]);export{S as default};
