import{b as e,a8 as l,a9 as a,aa as t,ab as o,d as u,ac as s,ad as r,ae as n,af as d,ag as i,e as v,ah as f,ai as c,U as p,E as m,aj as b,p as g,B as y,_ as h,ak as w,al as _,w as k,am as V,Q as x,v as D,z as K,x as F,q as C,a0 as S,a1 as $,l as P}from"./index-2b8f59d9.js";import{v as q,P as T,a as U,e as j,d as R,f as I,J as B,I as A,i as E,D as H,u as M,L as N,F as O,h as Y,G as W,aa as L,x as z,M as G,N as Q,y as J,ad as X,S as Z,a4 as ee,B as le,c as ae,an as te,ao as oe,ac as ue,Q as se}from"./vxetable-90850a7d.js";import{E as re}from"./el-date-picker-3db28835.js";import{u as ne}from"./FitsTableProHook-c0d1a0dd.js";import{F as de}from"./FitsCard-f9fd0b1a.js";import"./echarts-c32f5a2f.js";import"./index-2a794201.js";const ie=e({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:l(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:l([Function,Array]),default:a},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:t.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String}),ve={[o]:e=>u(e),[s]:e=>u(e),[r]:e=>u(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>n(e)},fe=["aria-expanded","aria-owns"],ce={key:0},pe=["id","aria-selected","onClick"],me="ElAutocomplete",be=q({name:me,inheritAttrs:!1});const ge=k(h(q({...be,props:ie,emits:ve,setup(e,{expose:l,emit:a}){const t=e,u=d(),n=T(),h=i(),k=v("autocomplete"),V=U(),x=U(),D=U(),K=U();let F=!1,C=!1;const S=U([]),$=U(-1),P=U(""),q=U(!1),le=U(!1),ae=U(!1),te=j((()=>k.b(String(Math.floor(1e4*Math.random()))))),oe=j((()=>n.style)),ue=j((()=>(S.value.length>0||ae.value)&&q.value)),se=j((()=>!t.hideLoading&&ae.value)),re=j((()=>V.value?Array.from(V.value.$el.querySelectorAll("input")):[])),ne=()=>{ue.value&&(P.value=`${V.value.$el.offsetWidth}px`)},de=()=>{$.value=-1},ie=f((async e=>{if(le.value)return;const l=e=>{ae.value=!1,le.value||(w(e)?(S.value=e,$.value=t.highlightFirstItem?0:-1):_(me,"autocomplete suggestions must be an array"))};if(ae.value=!0,w(t.fetchSuggestions))l(t.fetchSuggestions);else{const a=await t.fetchSuggestions(e,l);w(a)&&l(a)}}),t.debounce),ve=e=>{const l=!!e;if(a(s,e),a(o,e),le.value=!1,q.value||(q.value=l),!t.triggerOnFocus&&!e)return le.value=!0,void(S.value=[]);ie(e)},be=e=>{var l;h.value||("INPUT"!==(null==(l=e.target)?void 0:l.tagName)||re.value.includes(document.activeElement))&&(q.value=!0)},ge=e=>{a(r,e)},ye=e=>{C?C=!1:(q.value=!0,a("focus",e),t.triggerOnFocus&&!F&&ie(String(t.modelValue)))},he=e=>{setTimeout((()=>{var l;(null==(l=D.value)?void 0:l.isFocusInsideContent())?C=!0:(q.value&&Ve(),a("blur",e))}))},we=()=>{q.value=!1,a(o,""),a("clear")},_e=async()=>{ue.value&&$.value>=0&&$.value<S.value.length?xe(S.value[$.value]):t.selectWhenUnmatched&&(a("select",{value:t.modelValue}),S.value=[],$.value=-1)},ke=e=>{ue.value&&(e.preventDefault(),e.stopPropagation(),Ve())},Ve=()=>{q.value=!1},xe=async e=>{a(s,e[t.valueKey]),a(o,e[t.valueKey]),a("select",e),S.value=[],$.value=-1},De=e=>{if(!ue.value||ae.value)return;if(e<0)return void($.value=-1);e>=S.value.length&&(e=S.value.length-1);const l=x.value.querySelector(`.${k.be("suggestion","wrap")}`),a=l.querySelectorAll(`.${k.be("suggestion","list")} li`)[e],t=l.scrollTop,{offsetTop:o,scrollHeight:u}=a;o+u>t+l.clientHeight&&(l.scrollTop+=u),o<t&&(l.scrollTop-=u),$.value=e,V.value.ref.setAttribute("aria-activedescendant",`${te.value}-item-${$.value}`)};return c(K,(()=>{ue.value&&Ve()})),R((()=>{V.value.ref.setAttribute("role","textbox"),V.value.ref.setAttribute("aria-autocomplete","list"),V.value.ref.setAttribute("aria-controls","id"),V.value.ref.setAttribute("aria-activedescendant",`${te.value}-item-${$.value}`),F=V.value.ref.hasAttribute("readonly")})),l({highlightedIndex:$,activated:q,loading:ae,inputRef:V,popperRef:D,suggestions:S,handleSelect:xe,handleKeyEnter:_e,focus:()=>{var e;null==(e=V.value)||e.focus()},blur:()=>{var e;null==(e=V.value)||e.blur()},close:Ve,highlight:De}),(e,l)=>(I(),B(M(y),{ref_key:"popperRef",ref:D,visible:M(ue),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[M(k).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${M(k).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:ne,onHide:de},{content:A((()=>[E("div",{ref_key:"regionRef",ref:x,class:H([M(k).b("suggestion"),M(k).is("loading",M(se))]),style:N({[e.fitInputWidth?"width":"minWidth"]:P.value,outline:"none"}),role:"region"},[O(M(p),{id:M(te),tag:"ul","wrap-class":M(k).be("suggestion","wrap"),"view-class":M(k).be("suggestion","list"),role:"listbox"},{default:A((()=>[M(se)?(I(),Y("li",ce,[O(M(m),{class:H(M(k).is("loading"))},{default:A((()=>[O(M(b))])),_:1},8,["class"])])):(I(!0),Y(W,{key:1},L(S.value,((l,a)=>(I(),Y("li",{id:`${M(te)}-item-${a}`,key:a,class:H({highlighted:$.value===a}),role:"option","aria-selected":$.value===a,onClick:e=>xe(l)},[z(e.$slots,"default",{item:l},(()=>[G(Q(l[e.valueKey]),1)]))],10,pe)))),128))])),_:3},8,["id","wrap-class","view-class"])],6)])),default:A((()=>[E("div",{ref_key:"listboxRef",ref:K,class:H([M(k).b(),e.$attrs.class]),style:N(M(oe)),role:"combobox","aria-haspopup":"listbox","aria-expanded":M(ue),"aria-owns":M(te)},[O(M(g),J({ref_key:"inputRef",ref:V},M(u),{clearable:e.clearable,disabled:M(h),name:e.name,"model-value":e.modelValue,onInput:ve,onChange:ge,onFocus:ye,onBlur:he,onClear:we,onKeydown:[l[0]||(l[0]=X(Z((e=>De($.value-1)),["prevent"]),["up"])),l[1]||(l[1]=X(Z((e=>De($.value+1)),["prevent"]),["down"])),X(_e,["enter"]),X(Ve,["tab"]),X(ke,["esc"])],onMousedown:be}),ee({_:2},[e.$slots.prepend?{name:"prepend",fn:A((()=>[z(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:A((()=>[z(e.$slots,"append")]))}:void 0,e.$slots.prefix?{name:"prefix",fn:A((()=>[z(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:A((()=>[z(e.$slots,"suffix")]))}:void 0]),1040,["clearable","disabled","name","model-value","onKeydown"])],14,fe)])),_:3},8,["visible","placement","popper-class","teleported","transition"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/autocomplete/src/autocomplete.vue"]])),ye=e=>(te("data-v-c5204399"),e=e(),oe(),e),he=ye((()=>E("i",{class:"vxe-icon-add"},null,-1))),we=ye((()=>E("span",{class:"redStar"},"*",-1))),_e=ye((()=>E("i",{class:"vxe-icon-delete"},null,-1))),ke={class:"dataBox"},Ve=P(q({__name:"DynamicTable",setup(e){const l=U(),a=U([]),t=U({}),o=U(),u=U(),s=U(),{fitsTablePro:r}=ne({keepSource:!0,columns:[{field:"add",title:"操作",width:80,slots:{default:"addDefault"}},{field:"project",title:"项目",slots:{default:"projectDefault",header:"requiredHeader"}},{field:"batch",title:"批次/迭代",slots:{default:"batchDefault",header:"requiredHeader"}},{field:"type",title:"工时类型",slots:{default:"typeDefault"}},{field:"task",title:"任务内容",slots:{default:"taskDefault",header:"requiredHeader"}},{field:"responsible",title:"责任人",slots:{default:"responsibleDefault",header:"requiredHeader"}},{field:"reviewer",title:"工时审核人",slots:{default:"reviewerDefault"}},{field:"startdate",title:"计划开始",slots:{default:"startdateDefault"}},{field:"enddate",title:"计划完成",slots:{default:"enddateDefault"}},{field:"delete",title:"操作",width:80,slots:{default:"deleteDefault"}}],data:[{project:"",batch:"",type:"",task:"",responsible:"",reviewer:"",startdate:"",enddate:""},{project:"",batch:"",type:"",task:"",responsible:"",reviewer:"",startdate:"",enddate:""},{project:"",batch:"",type:"",task:"",responsible:"",reviewer:"",startdate:"",enddate:""}],align:"center",toolbarConfig:{slots:{buttons:"buttons"}},rowConfig:{keyField:"rowKey",useKey:!0},columnConfig:{useKey:!0}},s),n=U([{value:"丰德开发框架项目"},{value:"2019年领床路径系统二期产品"},{value:"2019年领床路径系统一期产品"},{value:"开发组"},{value:"2022年特种机电设备检测"},{value:"健康档案系统"},{value:"2021年资产管理系统"},{value:"2023Vue升级"}]),d=(e,l)=>{l(e?n.value.filter((l=>-1!==l.value.toLowerCase().indexOf(e))):n.value)},i=U([{label:".net core开原框架研究",value:"0"},{label:"Fits Framework",value:"1"},{label:"PC后台管理网站",value:"2"},{label:"混合app-ionic5",value:"3"},{label:"辅助工具",value:"4"},{label:"新PC前端框架研发",value:"5"}]),v=U([{label:"项目管理",value:"0"},{label:"售前支持",value:"1"},{label:"需求分析",value:"2"},{label:"系统设计",value:"3"},{label:"功能开发",value:"4"}]),f=U([{label:"李小白",value:"0"},{label:"王辉",value:"1"},{label:"张冰冰",value:"2"},{label:"李萌萌",value:"3"},{label:"白静",value:"4"}]),c=le({project:[{required:!0,message:"请选择项目",trigger:"change"}],task:[{required:!0,message:"请输入任务内容",trigger:"change"}],batch:[{required:!0,message:"请选择批次",trigger:"change"}],responsible:[{required:!0,message:"请选择责任人",trigger:"change"}],startdate:[{validator:b,type:"date",trigger:"change"}],enddate:[{validator:b,type:"date",trigger:"change"}]});function p(){s.value.fitsTablePro.insertAt({project:"",batch:"",type:"",task:"",responsible:"",reviewer:"",startdate:"",enddate:""},-1),a.value=s.value.fitsTablePro.getTableData().tableData}function m(e,a){o.value=e.rowKey;const s="dateFormRef_"+e.rowKey+a.id;if(u.value=s,void 0===t.value[e.rowKey]?t.value[e.rowKey]={[a.field]:e[a.field]}:t.value[e.rowKey][a.field]=e[a.field],t.value[e.rowKey]&&void 0!==t.value[e.rowKey].startdate&&void 0!==t.value[e.rowKey].enddate){const t=s.split("_"),o="startdate"===a.field?Number(t.slice(-1))+1:Number(t.slice(-1))-1,u=`dateFormRef_${e.rowKey}col_${o}`;l.value.refs[u].validate()}}function b(e,l,a,u,s){if(t.value[o.value]&&l)if(t.value[o.value]&&t.value[o.value].startdate&&t.value[o.value].enddate)if(V(t.value[o.value].startdate).isBefore(t.value[o.value].enddate))a();else{const l="startdate"===e.field?"不得大于结束时间":"不得小于开始时间";a(new Error(l))}else a();else a()}function y(){a.value=s.value.fitsTablePro.getTableData().tableData}function h(){let e=0,a=0,t=0,o=0;for(let u in l.value.refs)-1!==u.indexOf("requiredFormRef_")&&null!==l.value.refs[u]&&a++,-1!==u.indexOf("dateFormRef_")&&null!==l.value.refs[u]&&o++;for(let u in l.value.refs)-1!==u.indexOf("requiredFormRef_")&&null!==l.value.refs[u]&&l.value.refs[u].validate(((l,a)=>{l&&e++})),-1!==u.indexOf("dateFormRef_")&&null!==l.value.refs[u]&&l.value.refs[u].validate(((l,u)=>{l&&(t++,e===a&&t===o&&D({message:"保存成功",type:"success"}))}))}return R((()=>{l.value=ae()})),(e,l)=>{const t=K,o=ge,u=F,n=C,b=S,w=$,_=g,k=re;return I(),Y(W,null,[O(M(x),{option:M(r),ref_key:"xGrid",ref:s},{buttons:A((()=>[O(t,{onClick:y},{default:A((()=>[G(" 获取数据 ")])),_:1}),O(t,{onClick:h},{default:A((()=>[G(" 保存 ")])),_:1})])),addDefault:A((()=>[O(t,{onClick:p},{default:A((()=>[he])),_:1})])),requiredHeader:A((({slotProps:{column:e}})=>[we,E("span",null,Q(e.title),1)])),projectDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"requiredFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"project"},{default:A((()=>[O(o,{modelValue:e.project,"onUpdate:modelValue":l=>e.project=l,placeholder:"请输入","fetch-suggestions":d,clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),batchDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"requiredFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"batch"},{default:A((()=>[O(w,{modelValue:e.batch,"onUpdate:modelValue":l=>e.batch=l},{default:A((()=>[(I(!0),Y(W,null,L(M(i),(e=>(I(),B(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),typeDefault:A((({slotProps:{row:e}})=>[O(u,null,{default:A((()=>[O(w,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l},{default:A((()=>[(I(!0),Y(W,null,L(M(v),(e=>(I(),B(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),taskDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"requiredFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"task"},{default:A((()=>[O(_,{modelValue:e.task,"onUpdate:modelValue":l=>e.task=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),responsibleDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"requiredFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"responsible"},{default:A((()=>[O(w,{modelValue:e.responsible,"onUpdate:modelValue":l=>e.responsible=l},{default:A((()=>[(I(!0),Y(W,null,L(M(f),(e=>(I(),B(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),reviewerDefault:A((({slotProps:{row:e}})=>[O(u,null,{default:A((()=>[O(w,{modelValue:e.reviewer,"onUpdate:modelValue":l=>e.reviewer=l},{default:A((()=>[(I(!0),Y(W,null,L(M(f),(e=>(I(),B(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),startdateDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"dateFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"startdate"},{default:A((()=>[O(k,{modelValue:e.startdate,"onUpdate:modelValue":l=>e.startdate=l,"value-format":"YYYY-MM-DD",onChange:a=>m(e,l)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),enddateDefault:A((({slotProps:{row:e,column:l}})=>[(I(),B(n,{ref:"dateFormRef_"+e.rowKey+l.id,model:e,rules:M(c),key:e.rowKey},{default:A((()=>[O(u,{prop:"enddate"},{default:A((()=>[O(k,{modelValue:e.enddate,"onUpdate:modelValue":l=>e.enddate=l,"value-format":"YYYY-MM-DD",onChange:a=>m(e,l)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1024)])),_:2},1032,["model","rules"]))])),deleteDefault:A((({slotProps:{row:e}})=>[O(t,{onClick:l=>function(e){s.value.fitsTablePro.remove(e),a.value=s.value.fitsTablePro.getTableData().tableData}(e)},{default:A((()=>[_e])),_:2},1032,["onClick"])])),_:1},8,["option"]),E("div",ke," 表格数据： "+Q(M(a)),1)],64)}}}),[["__scopeId","data-v-c5204399"]]),xe={class:"dynamic-table"},De={class:"content"},Ke={class:"right"},Fe={class:"menu"},Ce=(e=>(te("data-v-7fcb825c"),e=e(),oe(),e))((()=>E("div",{class:"menu-title"},"此页内容",-1))),Se=["id","onClick"],$e=q({name:"DynamicTable"}),Pe=P(q({...$e,setup(e){const l=U([]),a=le({num:0});let t=0;const o={callback:function(e){l.value=e},selectors:["h1","h2"],exceptSelector:"[un-nav]",listenScroll:!0};const u=e=>{if(null!==t)s(t);else if(null===t)for(let t=0;t<l.value.length;t++){let o=document.getElementById("menuItem"+t);l.value[t].pos.top<=e.scrollTop+l.value[0].pos.top&&o&&(a.num=t)}},s=e=>{for(let a=0;a<l.value.length;a++){let l=document.getElementById("menuItem"+a);e!==a&&l&&(l.className="defaultStyle")}setTimeout((()=>{t=null}),100)};return(e,r)=>{const n=p,d=ue("outline");return I(),Y("div",xe,[O(n,{class:"left",onScroll:u,always:""},{default:A((()=>[se((I(),Y("div",De,[O(de,{title:"动态表格",desc:"动态表格展示了表单＋表格的结合使用。\n                表格内部的渲染器主要是通过表格插槽实现的。"},{default:A((()=>[O(Ve)])),_:1})])),[[d,o]])])),_:1}),E("div",Ke,[E("div",Fe,[Ce,(I(!0),Y(W,null,L(M(l),((e,l)=>(I(),Y("div",{class:H([{active:M(a).num===l},"defaultStyle"]),key:l,id:"menuItem"+l,onClick:Z((o=>function(e,l){t=l,a.num=l,e.scrollIntoView({block:"start",inline:"nearest"}),s(t)}(e.el,l)),["stop"])},Q(e.title),11,Se)))),128))])])])}}}),[["__scopeId","data-v-7fcb825c"]]);export{Pe as default};
