import{y as e,S as a,c as l,d as t,ar as o,X as s,f as i,h as d,j as r,N as n,H as p,u,D as m,K as c,G as f,L as b,A as y,o as h,n as g,M as k}from"./vxetable.d7bee61f.js";import{d as C}from"./system.582bdff5.js";import{_ as T,f as v,c as _}from"./index.30d84996.js";import{j as w,c as V,b as x,k as I,l as U,d as D,i as P}from"./index.5f391711.js";import{u as S}from"./FitsTableProHook.5425d7a7.js";import"./echarts.d8b3161e.js";import"./moment.9709ab41.js";const j={class:"add-role"},z={class:"add-content"},L={style:{display:"flex",width:"100%","justify-content":"space-between"}},W={key:1,style:{display:"flex","justify-content":"flex-start"}},E={key:3,style:{display:"flex","justify-content":"space-between",width:"100%"}},F={class:"add-bottom"};var q=T(e({__name:"addMenu",props:{keys:String,setData:Object,requireData:Array},emits:["dataChange","closeDialog"],setup(e,{emit:h}){const g=e,k=a(new w({select:{clearable:!0}})),C=a(new V({select:{clearable:!0},tree:{nodeKey:"Id",data:[],checkStrictly:!0}})),T=l("default"),_=l();let D=a({Title:"",Icon:"",Type:"",Sort:"",ComponentPath:"",IsUrL:!1,IsCache:!1,State:!1,CreateTime:"",Address:"",ComponentName:""});t((()=>g.setData),(()=>{D=Object.assign(D,g.setData)}),{immediate:!0,deep:!0}),t((()=>g.requireData),(()=>{C.tree.data=Object.assign(C.tree.data,g.requireData),o.eachTree(C.tree.data,(e=>{e.label=e.Title}),{children:"children"})}),{immediate:!0,deep:!0});const P=a({Title:[{required:!0,message:"请输入菜单标题",trigger:"blur"}],Type:[{required:!0,message:"请选择菜单类型",trigger:"blur"},{min:3,max:10,message:"长度请大于3，小于10",trigger:"blur"}]}),S=e=>{"cancle"!=e?_.value&&_.value.validate((e=>{if(!e)return v({message:"必填项未填写完整！",type:"warning"}),!1;if("edit"==g.keys){let e=o.clone(D);h("dataChange",e,g.keys),h("closeDialog","operate")}else if("add"==g.keys){let e=o.clone(D);h("dataChange",e,g.keys),h("closeDialog","operate")}})):h("closeDialog","operate")};return(e,a)=>{const l=s("el-form-item"),t=s("el-input"),o=s("el-button"),h=s("el-radio"),g=s("el-radio-group"),v=s("el-form");return i(),d("div",j,[r("div",z,[n(v,{ref_key:"ruleFormRef",ref:_,model:u(D),rules:P,"label-width":"120px",class:"demo-ruleForm",size:T.value,"status-icon":""},{default:p((()=>[n(l,{label:"上级目录",prop:"CreateTime"},{default:p((()=>[n(u(x),m({options:C},u(D).CreateTime),null,16,["options"])])),_:1}),n(l,{label:"菜单类型",prop:"Type"},{default:p((()=>[c(" 只放按钮会导致字体没有加粗 "),n(t,{style:{display:"none"}}),"mulu"!=u(D).Type?(i(),f(o,{key:0,class:"add-button",onClick:a[0]||(a[0]=e=>u(D).Type="mulu")},{default:p((()=>[b("目录")])),_:1})):c("v-if",!0),"mulu"==u(D).Type?(i(),f(o,{key:1,class:"add-button",onClick:a[1]||(a[1]=e=>u(D).Type="mulu"),type:"primary",plain:""},{default:p((()=>[b("目录")])),_:1})):c("v-if",!0),"caidan"!=u(D).Type?(i(),f(o,{key:2,class:"add-button",onClick:a[2]||(a[2]=e=>u(D).Type="caidan")},{default:p((()=>[b("菜单 ")])),_:1})):c("v-if",!0),"caidan"==u(D).Type?(i(),f(o,{key:3,class:"add-button",onClick:a[3]||(a[3]=e=>u(D).Type="caidan"),type:"primary",plain:""},{default:p((()=>[b("菜单")])),_:1})):c("v-if",!0),"anniu"!=u(D).Type?(i(),f(o,{key:4,class:"add-button",onClick:a[4]||(a[4]=e=>u(D).Type="anniu")},{default:p((()=>[b("按钮")])),_:1})):c("v-if",!0),"anniu"==u(D).Type?(i(),f(o,{key:5,class:"add-button",onClick:a[5]||(a[5]=e=>u(D).Type="anniu"),type:"primary",plain:""},{default:p((()=>[b("按钮")])),_:1})):c("v-if",!0),"shuju"!=u(D).Type?(i(),f(o,{key:6,class:"add-button",onClick:a[6]||(a[6]=e=>u(D).Type="shuju")},{default:p((()=>[b("数据")])),_:1})):c("v-if",!0),"shuju"==u(D).Type?(i(),f(o,{key:7,class:"add-button",onClick:a[7]||(a[7]=e=>u(D).Type="shuju"),type:"primary",plain:""},{default:p((()=>[b("数据")])),_:1})):c("v-if",!0)])),_:1}),n(l,{label:"菜单图标"},{default:p((()=>[r("div",L,[n(u(I),{options:k,class:y("addMenuClass")},null,8,["options"]),n(u(U),{url:"http://192.168.32.108:3000/mock/78/api/uploadPDF",type:["images"],ClassName:"uploadClass"},{mybutton:p((()=>[n(o,{class:"add-button",type:"primary",plain:""},{default:p((()=>[b("开始上传")])),_:1})])),_:1})])])),_:1}),"anniu"!=u(D).Type?(i(),f(l,{key:0,label:"菜单标题",prop:"Title"},{default:p((()=>[n(t,{modelValue:u(D).Title,"onUpdate:modelValue":a[8]||(a[8]=e=>u(D).Title=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):c("v-if",!0),"anniu"!=u(D).Type?(i(),d("div",W,[n(l,{label:"菜单状态",prop:"State",style:{display:"flex","align-items":"center"}},{default:p((()=>[n(g,{modelValue:u(D).State,"onUpdate:modelValue":a[9]||(a[9]=e=>u(D).State=e),class:"ml-4"},{default:p((()=>[n(h,{label:!0,size:"large"},{default:p((()=>[b("启用")])),_:1}),n(h,{label:!1,size:"large"},{default:p((()=>[b("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1}),n(l,{label:"外链菜单",prop:"IsUrL",style:{display:"flex","align-items":"center"}},{default:p((()=>[n(g,{modelValue:u(D).IsUrL,"onUpdate:modelValue":a[10]||(a[10]=e=>u(D).IsUrL=e),class:"ml-4"},{default:p((()=>[n(h,{label:!0,size:"large"},{default:p((()=>[b("是")])),_:1}),n(h,{label:!1,size:"large"},{default:p((()=>[b("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])):c("v-if",!0),c(" 菜单类型选择按钮是显示 "),"anniu"==u(D).Type?(i(),f(l,{key:2,label:"按钮名称",prop:"Title"},{default:p((()=>[n(t,{modelValue:u(D).Title,"onUpdate:modelValue":a[11]||(a[11]=e=>u(D).Title=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):c("v-if",!0),c(" 菜单类型选择菜单时显示 "),"caidan"==u(D).Type?(i(),d("div",E,[n(l,{label:"组件名称",prop:"ComponentName",style:{display:"flex","align-items":"center"}},{default:p((()=>[n(t,{modelValue:u(D).ComponentName,"onUpdate:modelValue":a[12]||(a[12]=e=>u(D).ComponentName=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),n(l,{label:"组件路径",prop:"Address",style:{display:"flex","align-items":"center"}},{default:p((()=>[n(t,{modelValue:u(D).Address,"onUpdate:modelValue":a[13]||(a[13]=e=>u(D).Address=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])):c("v-if",!0),"anniu"!=u(D).Type?(i(),f(l,{key:4,label:"路由地址",prop:"ComponentPath"},{default:p((()=>[n(t,{modelValue:u(D).ComponentPath,"onUpdate:modelValue":a[14]||(a[14]=e=>u(D).ComponentPath=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):c("v-if",!0),n(l,{label:"菜单排序",prop:"Sort"},{default:p((()=>[n(t,{modelValue:u(D).Sort,"onUpdate:modelValue":a[15]||(a[15]=e=>u(D).Sort=e),rows:"5",resize:"none",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","size"])]),r("div",F,[n(o,{class:"add-button",size:"large",onClick:a[16]||(a[16]=e=>S("cancle"))},{default:p((()=>[b("取消")])),_:1}),n(o,{class:"add-button",type:"primary",size:"large",onClick:a[17]||(a[17]=e=>S("submit"))},{default:p((()=>[b("确定 ")])),_:1})])])}}}),[["__scopeId","data-v-8455b754"]]);const R={class:"menu-manage"},A=["onClick"],M=["onClick"],N=e({name:"Menu"});var O=T(e({...N,setup(e){const{user:t}=_(),m=l(),f={keepSource:!0,showOverflow:!1,id:"toolbar_demo_1",rowConfig:{height:52},storage:{enabled:!0,key:"SystemManageMenuList",dataBase:t.userInfo.id},formConfig:{items:[{field:"keyword",title:"模糊搜索",itemRender:{name:"ElInput",props:{placeholder:"请输入菜单关键字、权限标识、路径"}}}]},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:50},{field:"Title",title:"菜单标题",minWidth:130,treeNode:!0},{field:"Icon",title:"图标",minWidth:100},{field:"Type",title:"组件标识",minWidth:100},{field:"ComponentPath",title:"组件路径",minWidth:100},{field:"IsUrL",title:"外链",minWidth:100,slots:{default:"isUrL"}},{field:"IsCache",title:"缓存",minWidth:100,slots:{default:"isCache"}},{field:"State",title:"菜单状态",slots:{default:"state"},minWidth:100},{field:"Sort",title:"排序",minWidth:80},{field:"CreateTime",title:"创建日期",minWidth:130},{field:"Operation",title:"操作",minWidth:150,slots:{default:"operate"},fixed:"right"}],toolbarConfig:{buttons:[{code:"myadd",name:"新增",status:"primary",onClick:()=>{alert(1)}},{code:"mySave",name:"启用"},{code:"mydisable",name:"禁用"},{code:"myExport",name:"导出"},{code:"mydelete",name:"批量删除"}],tools:{enabled:!0}},treeConfig:{transform:!0,rowField:"Id",parentField:"PId"},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((a=>{C(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:l}=e;l?(T.value=l.TableList,a({result:o.toTreeArray(l.TableList,{clear:!0}),page:{total:l.ItemCount}})):a({result:[],page:{total:0}})}))}))}}};let T=l("");const{fitsTablePro:w}=S(f,m),V={async toolbarButtonClick({code:e}){if(m.value.fitsTablePro.getCheckboxRecords().length||"myadd"==e)switch(e){case"myadd":{I.operate.visible=!0,I.operate.key="add";let e={Title:"",Icon:"",Type:"",Sort:"",ComponentPath:"",IsUrL:!1,IsCache:!1,State:!1,CreateTime:""};I.operate.data=e;break}case"mySave":I.base.visible=!0,I.base.dialogText="是否启用所选菜单？";break;case"mydisable":I.base.visible=!0,I.base.dialogText="是否禁用所选菜单？";break;case"myExport":I.base.visible=!0,I.base.dialogText="是否导出所选菜单？";break;case"mydelete":I.base.visible=!0,I.base.dialogText="是否删除所选菜单？"}else x()}},x=()=>{v({message:"请选择至少一个角色！",type:"warning"})},I=a({base:{dialogText:"",key:"",visible:!1,props:{title:"",width:"30%"}},operate:{dialogText:"",key:"",visible:!1,data:{},props:{title:"",width:"50%"}}}),U=e=>{switch(e){case"operate":I.operate.visible=!1;break;case"base":I.base.visible=!1}};h((()=>{g((()=>{})),setTimeout((()=>{}),2e3)}));const j=(e,a)=>{"edit"==I.operate.key||I.operate.key},z=(e,a)=>{"edit"==a?(I.operate.visible=!0,I.operate.props.title="编辑菜单",I.operate.key="editRole",I.operate.data=e):"delete"==a&&(I.base.visible=!0,I.base.dialogText="是否确定关联选中的用户？",I.base.key="relaRole")};return(e,a)=>{const l=s("el-switch");return i(),d("div",R,[c(" <fits-list-seach :formItem='formItem' /> "),n(u(D),{option:u(w),ref_key:"xGrid",ref:m,"grid-events":V},{operate:p((({slotProps:e})=>[r("span",{class:"FromButton underline",onClick:a=>z(e.row,"edit")},"编辑",8,A),r("span",{class:"FromButton delete",onClick:a=>z(e.row,"delete")},"删除",8,M)])),isUrl:p((({slotProps:e})=>[n(l,{modelValue:e.row.IsUrl,"onUpdate:modelValue":a=>e.row.IsUrl=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),isCache:p((({slotProps:e})=>[n(l,{modelValue:e.row.IsCache,"onUpdate:modelValue":a=>e.row.IsCache=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),state:p((({slotProps:e})=>[n(l,{modelValue:e.row.IsEnabled,"onUpdate:modelValue":a=>e.row.IsEnabled=a,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"]),c(" {{ slotProps.row.Ustate }} ")])),_:1},8,["option"]),c(" 工具栏操作确认弹窗（关联、启用、禁用、导出、删除） "),n(u(P),{class:y("Menu-baseDialog"),visible:I.base.visible,dialogProp:I.base.props,onCancel:a[0]||(a[0]=e=>U("base")),onSubmit:a[1]||(a[1]=e=>(e=>{let a=m.value.fitsTablePro.getCheckboxRecords(!0);switch(e){case"Dictable":a.forEach(((e,a)=>{e.IsEnabled=!0}));break;case"Dictunable":a.forEach(((e,a)=>{e.IsEnabled=!1}))}U("base")})(I.base.key))},{default:p((()=>[b(k(I.base.dialogText),1)])),_:1},8,["visible","dialogProp"]),c(" 数据弹窗（新增业务字典、字典、编辑字典分类） "),n(u(P),{class:y("onfooter"),visible:I.operate.visible,"dialogData.relateRole.visible":"false",dialogProp:I.operate.props,showFooter:!1,onCancel:a[2]||(a[2]=e=>U("operate"))},{default:p((()=>[n(q,{onDataChange:j,onCloseDialog:U,keys:I.operate.key,setData:I.operate.data,requireData:u(T)},null,8,["keys","setData","requireData"])])),_:1},8,["visible","dialogProp"])])}}}),[["__scopeId","data-v-6743ebf0"]]);export{O as default};
