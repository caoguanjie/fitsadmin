import{k as e,n as t,F as a,J as l,a7 as i,a4 as o,a2 as r,a5 as s,a6 as n}from"./index.0ea97641.js";import{F as d,c as p,aB as m,o as c,n as b,Z as f,af as u,l as g,m as h,U as v,S as y,u as D,Q as P,p as k,a6 as x,W as T}from"./vxetable.5e2aec1d.js";import{c as C}from"./system.6337f85a.js";import{u as w}from"./FitsTableProHook.bf67f2a4.js";import{E as I}from"./index.48af26c2.js";import"./echarts.d8b3161e.js";const R={class:"department-manage"},S=["onClick"],W=["onClick"],j=d({name:"Department"});var q=e(d({...j,setup(e){const{user:d}=t(),j=p(),q={keepSource:!0,id:"department-part",rowConfig:{height:52,isHover:!0,useKey:!0},storage:{enabled:!0,key:"SystemManageDepartmentList",dataBase:d.userInfo.id},formConfig:{items:[{field:"name",span:3,title:"部门名称",itemRender:{name:"$input",props:{placeholder:"请输入部门名称"}}},{field:"code",span:3,title:"部门编码",itemRender:{name:"$input",props:{placeholder:"请输入部门编码"}}},{field:"status",span:3,title:"部门状态",itemRender:{name:"$select",options:[{value:"0",label:"启用"},{value:"1",label:"停用"}],props:{placeholder:"请选择状态"}}}]},importConfig:{},exportConfig:{},pagerConfig:{enabled:!0},columns:[{field:"Checkbox",type:"checkbox",title:"多选",minWidth:60},{field:"Title",title:"部门名称",minWidth:210,treeNode:!0},{field:"code",title:"部门编码",minWidth:150,align:"center"},{field:"Sort",title:"排序",minWidth:150,align:"center"},{field:"remark",title:"备注",minWidth:120},{field:"status",title:"部门状态",minWidth:120,slots:{default:"status"},align:"center"},{field:"CreateTime",title:"创建时间",minWidth:180,align:"center"},{field:"Operation",title:"操作",minWidth:150,slots:{default:"operate"},fixed:"right"}],showOverflow:"tooltip",toolbarConfig:{buttons:[{code:"add",name:"新增部门",status:"primary"},{code:"enable",name:"启用"},{code:"disable",name:"禁用"},{code:"export",name:"导出"},{code:"Depdelete",name:"批量删除"}],tools:{enabled:!0}},treeConfig:{transform:!0,rowField:"id",parentField:"PId"},proxyConfig:{form:!0,autoLoad:!0,ajax:{query:({form:e})=>new Promise((t=>{C(e,{pageIndex:11,pageSize:23}).then((e=>{const{ReturnData:a}=e;t(a?{result:m.toTreeArray(a.TableList,{clear:!0}),page:{total:a.ItemCount}}:{result:[],page:{total:0}})}))}))}},tooltipConfig:{contentMethod:({column:e,row:t})=>{const{field:a}=e;if("remark"===a)return t[a]}}},F={async toolbarButtonClick({code:e}){let t=j.value.fitsTablePro.getCheckboxRecords();switch(e){case"add":L.visible=!0,L.dialogProp.title="新增部门";break;case"enable":t.length?(E.baseDepartment.visible=!0,E.baseDepartment.dialogText="是否确定启用选中的部门?",E.baseDepartment.key="Departmentenable"):I({message:"未选中启动的相关部门",type:"error"});break;case"disable":t.length?(E.baseDepartment.visible=!0,E.baseDepartment.dialogText="是否确定禁用选中的部门?",E.baseDepartment.key="Departmentdisable"):I({message:"未选中禁用的相关部门",type:"error"});break;case"export":break;case"Depdelete":t.length?(E.baseDepartment.visible=!0,E.baseDepartment.dialogText="是否确定删除选中的部门?",E.baseDepartment.key="Departmentremove"):I({message:"未选中删除的相关部门",type:"error"})}}};let _=p();const{fitsTablePro:B}=w(q,j);c((()=>{b((()=>{})),setTimeout((()=>{}),2e3)}));const E=f({addDepartment:{visible:!1,props:{title:"新增部门",width:"40%"},info:{}},baseDepartment:{dialogText:"",key:"",visible:!1,props:{title:"提示",width:"30%"}}}),V=e=>{switch(e){case"addDepartment":E.addDepartment.visible=!1;break;case"baseDepartment":E.baseDepartment.visible=!1,j.value.fitsTablePro.setAllCheckboxRow(!1)}};let A=p();const L=f({visible:!1,forms:[{form:new a({rule:[{type:"title",field:"PId",title:"上级部门",component:u(o),props:{options:new l({select:{placeholder:"请选择",clearable:!0},input:{placeholder:"部门搜索"},tree:{nodeKey:"id",data:[{id:"150000198607018427",label:"广州华侨医院",children:[{id:"15000019860701848",PId:"150000198607018427",label:"医院医技",children:[{id:"15000019860701842",PId:"15000019860701848",label:"医院医技01"},{id:"15000019860701846",PId:"15000019860701848",label:"医院医技02"}]}]},{id:"150000198607018400",label:"广州第一人民医院",children:[{id:"16000019860701848",PId:"150000198607018400",label:"医院医技",children:[{id:"15100019860701842",PId:"16000019860701848",label:"医院医技01"},{id:"15120019860701842",PId:"16000019860701848",label:"医院医技02"}]}]},{id:"150100198607018400",label:"广州南方医科附属第三医院",children:[{id:"16000019860701748",PId:"150100198607018400",label:"医院医技",children:[{id:"15100019860721842",PId:"16000019860701748",label:"医院医技01"},{id:"15100019860751842",PId:"16000019860701748",label:"医院医技02"}]}]}],checkStrictly:!0}})},validate:[{required:!0,message:"请选择",trigger:"change"}]},{type:"input",field:"Title",title:"部门名称",props:{placeholder:"请输入"},effect:{required:"请输入部门名称"}},{type:"input",field:"code",title:"部门编号",props:{placeholder:"请输入"},effect:{required:"请输入部门编号"}},{type:"input",field:"remark",title:"部门描述",props:{placeholder:"请输入"}},{type:"input",field:"Sort",title:"排序",props:{placeholder:"请输入"}},{type:"radio",field:"status",title:"状态",options:[{value:!0,label:"启用"},{value:!1,label:"禁用"}]}],option:{form:{labelPosition:"right",inline:!0},submitBtn:!1,resetBtn:!1},col:1})}],dialogProp:{title:"",width:"35%"},formType:"dialog"});function O(e){if(L.dialogProp.title="新增部门")L.visible=!1;else if(L.dialogProp.title="修改部门"){let t=j.value.fitsTablePro.reactData.tableData.find((e=>e.id==A.value.id));Object.assign(t,e),j.value.fitsTablePro.commitProxy("query"),L.visible=!1}}return(e,t)=>{const a=i;return g(),h("div",R,[v(D(r),{option:D(B),ref_key:"xGrid",ref:j,"grid-events":F},{operate:y((({slotProps:e})=>[k("span",{onClick:t=>{return a=e.row,A.value=a,L.visible=!0,L.dialogProp.title="修改部门","null"===a.PId&&(a.PId=a.id),void b((()=>{_.value.formRef.forEach((e=>{e.fApi.setValue(a)}))}));var a}},"编辑",8,S),k("span",{onClick:t=>(async e=>{E.baseDepartment.visible=!0,E.baseDepartment.dialogText="是否确定删除选中的部门?"})(e.row)},"删除",8,W)])),status:y((({slotProps:e})=>[v(a,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,style:{"--el-switch-on-color":"#000000","--el-switch-off-color":"#dcdfe6"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["option"]),v(D(s),{option:L,onSubmit:O,onCancel:t[0]||(t[0]=e=>L.visible=!1),class:"dialogFormExample",ref_key:"formtypeRef",ref:_},null,8,["option"]),v(D(n),{class:P(["baseDepartment","Department-baseDialog"]),visible:E.baseDepartment.visible,dialogProp:E.baseDepartment.props,onSubmit:t[1]||(t[1]=e=>(e=>{const t=j.value;let a=j.value.fitsTablePro.getCheckboxRecords(!0);switch(e){case"Departmentenable":a.forEach(((e,t)=>{e.status=!0})),b((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentdisable":a.forEach(((e,t)=>{e.status=!1})),b((()=>{t.fitsTablePro.commitProxy("query")}));break;case"Departmentremove":t.fitsTablePro.remove(a),b((()=>{t.fitsTablePro.commitProxy("query")}))}V("baseDepartment")})(E.baseDepartment.key)),onCancel:t[2]||(t[2]=e=>V("baseDepartment"))},{default:y((()=>[x(T(E.baseDepartment.dialogText),1)])),_:1},8,["visible","dialogProp"])])}}}),[["__scopeId","data-v-4246b1bb"]]);export{q as default};
